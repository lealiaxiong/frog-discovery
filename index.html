<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name='robots' content='max-image-preview:large' />
    <title>Frog discovery &#8211; Lealia Xiong</title>

    <link rel='stylesheet' id='style'
        href='https://cdn.jsdelivr.net/gh/lealiaxiong/lealiaxiong.github.io@main/style.css' type='text/css'
        media='all' />
    <link rel='stylesheet' id='style' href='toc.css' type='text/css' media='all' />

    <!--Nav bar for small screens-->
    <script type='text/javascript'
        src='https://cdn.jsdelivr.net/gh/lealiaxiong/lealiaxiong.github.io@main/navbar_mobile.js'></script>


    <link rel="canonical" href="https://lealiaxiong.github.io/frog-discovery" />

    <!-- Open Graph Tags -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Lealia Xiong &#8211;&nbsp;Data Science &#8211;&nbsp; Frog discovery" />
    <meta property="og:description" content="Data / Science / Startups" />
    <meta property="og:url" content="https://lealiaxiong.github.io/frog-discovery" />
    <meta property="og:site_name" content="Lealia Xiong" />
    <meta property="og:image" content="images/litoria-fallax-2.png" />
    <meta property="og:image:width" content="2100" />
    <meta property="og:image:height" content="1500" />
    <meta property="og:image:alt" content="" />
    <meta property="og:locale" content="en_US" />
    <meta property="article:publisher" content="https://www.linkedin.com/in/lealiaxiong" />
    <meta name="twitter:text:title" content="Lealia Xiong &#8211;&nbsp;Data Science &#8211;&nbsp; Frog discovery" />
    <meta name="twitter:image" content="images/litoria-fallax-2.pngg" />
    <meta name="twitter:card" content="summary_large_image" />
    <!-- End Open Graph Tags -->
</head>

<body>
    <div>
        <!--Header and navigation-->
        <div id="navbar"></div>

        <script>
            fetch('https://cdn.jsdelivr.net/gh/lealiaxiong/lealiaxiong.github.io@main/navbar.html')
                .then(response => response.text())
                .then(data => document.getElementById('navbar').innerHTML = data);
        </script>

        <main>
            <div class="wp-container-9 ">
                <h1>Frog discovery</h1>
                <h3>A species distribution model of <i>Litoria fallax</i> in Australia</h3>
                <p><b>Lealia Xiong and <a href="https://rlearsch.github.io/portfolio/20220618_Frog-club-md/">Robert
                            Learsch</a></b></p>

                <p>
                    2022 EY Better Working World Global Data Challenge | Level 1 </br>
                    <b>Global Semifinalists</b> - 4th place on the public leaderboard / top 5 in Americas region
                </p>

                <div class="wp-container-7 wp-block-group">
                    <img style="width:25%" src="images/litoria-fallax-2.png" alt="
                    Digital drawing of Litoria fallax, the eastern dwarf tree frog. 
                    The frog is sitting in profile, facing to the right.
                    It is green all over its back and limbs with a light cream and gray underside.
                    Its eye is surrounded by a gray circle with a stripe pointing towards its nose. 
                    Its front limbs are slightly extended away from the body.
                    ">
                    <img style="width:25%" src="images/litoria-fallax-1.png" alt="
                    A second digital drawing of Litoria fallax.
                    The frog is sitting in profile, facing to the left.
                    It is light green all over its back and limbs with a light cream and brownish-gray underside.
                    Its eye is surrounded by a brownish-gray circle with a stirp pointing towards its nose.
                    Its limbs are compact.
                    ">
                </div>
            </div>

            <div class="wp-container-1 items-justified-center">
                <div class="table-of-contents">
                    <ul>
                        <li><a href="#motivation">Motivation</a></li>
                        <li><a href="#model-data-description">Model and Data Description</a></li>
                        <li><a href="#results-and-discussion">Results and Discussion</a></li>
                        <li><a href="#conclusion">Conclusion</a></li>
                        <li><a href="#references">References</a></li>
                        <li><a href="#data-sources">Data Sources</a></li>
                        <li><a href="#data-tools">Data Tools</a></li>
                    </ul>
                </div>
            </div>

            <div class="wp-container-9 entry-content wp-block-post-content">
                <section id="motivation">
                    <h3>Motivation</h3>
                </section>

                <p>
                    The decline of frogs is a bellwether for the decline of the broader ecosystem.
                    Frogs are an indicator species—a frog population’s health reflects the surrounding environmental
                    conditions, and they are sensitive to both air and water quality [1].
                </p>
                <p>
                    Unfortunately, frog populations around the world are diminishing, with some species even
                    disappearing.
                    As of 2021, the International Union for Conservation of Nature Red List of Threatened Species
                    includes
                    at least one third of amphibian species [2]. In Australia alone, four species of frogs are
                    officially
                    listed as extinct [3], with an additional three recently found to be likely extinct [4].
                </p>
                <p>
                    To protect frogs and probe the health of their ecosystems, scientists need to understand where frogs
                    live
                    and how their numbers and distribution are changing over time. To assist with this mission, we have
                    built
                    a machine learning model to predict the distribution of <i>Litoria fallax</i>, the eastern dwarf
                    tree frog,
                    using observed location data from the Global Biodiversity Information Facility (GBIF)
                    in combination with temperature, precipitation, and soil moisture data from the TerraClimate
                    dataset.
                </p>

                <section id="model-data-description">
                    <h3>Model and data description</h3>
                </section>

                <p>
                    Our final model uses a <span class="green-emphasis">random forest classifier</span> algorithm,
                    imported from scikit-learn for Python. Our target dataset consists of
                    labeled occurrence data</span> for
                    five species of frogs in Australia, taken from the GBIF dataset provided by EY,
                    alongside predictor variables based on
                    <span class="green-emphasis">temperature, precipitation, and soil moisture data</span>
                    from the TerraClimate dataset, hosted by the Microsoft Planetary Computer.
                    We restricted the frog data to the period from 1 January 2015 to the present,
                    and climate data to the period from January 2015 to December 2019. To reduce the computational load,
                    rather than using the entire datasets, we sub-sampled nine 1° by 1° squares
                    (equivalent to ~111 km by 111 km) around the coast of Australia. After combining the sub-sampled
                    datasets,
                    we dropped 43 points that included missing data (of ~40,000 total points).
                </p>

                <p>
                    As George Box wrote, “All models are wrong, but some are useful.” In designing our model,
                    we made some <span class="green-emphasis">simplifying assumptions</span>. In selecting the date
                    range
                    of our data, we assumed that the distribution of <i>L. fallax</i> has not changed since 2015,
                    and that the effect of climate change on our environmental variables over the same period has not
                    been significant. Additionally, we used a binary classification model;
                    however, with our frog occurrence dataset, no confirmed absence points are provided.
                    Therefore, we assumed that the presence of other frog species indicated an absence of the target
                    species
                    and created pseudo-absence data accordingly.
                </p>

                <p>
                    Our <span class="green-emphasis">key innovations</span> in improving our model over the benchmark
                    included
                    a) a class balancing method that preserves isolated non-target frog occurrences,
                    b) simplifying features by aggregating data by month, and
                    c) creating features based on a variety of descriptive statistics.
                </p>

                <h4>a) Class balancing</h4>
                <p>
                    After labeling the occurrences of non-target frog species as pseudo-absences, our training dataset
                    contained 25,733 absences and 13,839 presences over all geographical areas sampled, a nearly 2:1
                    imbalance. The majority class, absences, is not the class of interest; this poses a challenge for
                    predicting the presences.
                </p>

                <p>
                    We developed a method to <span class="green-emphasis">downsample the absences while preserving
                        isolated ones</span>,
                    which may contain information that is not represented anywhere else (<a href="#figure-1">Figure
                        1</a>).
                    We searched each 1/24° by 1/24° “pixel” (the TerraClimate resolution) in our regions of interest
                    (ROI).
                    Where there were multiple absences per pixel, we randomly selected one to keep, removing the rest.
                    Because the number of kept absence points was less than the number of presence points,
                    we randomly sampled from the pool of removed points, adding them back into the training set until
                    the number of
                    presence and absence points were equal, resulting in a dataset containing 13,839 presence points and
                    13,839 absence points.
                </p>

                <section id="figure-1">
                    <img style="max-width:100%" src="images/fig1-downsampling.png" alt="">
                </section>
                <p>
                    <b>Figure 1. Downsampling off-target species occurrences while preserving isolated occurrences.</b>
                    A representative region of interest containing both the target frog species (blue) and off-target
                    frog species (orange). Each 1/24° by 1/24° “pixel” (indicated by the gridlines) that contained
                    off-target occurrences before downsampling retains at least one off-target occurrence after
                    downsampling.
                </p>

                <h4>b) Feature simplification</h4>
                <p>
                    We tested different variables from the TerraClimate dataset, and found that using
                    <span class="green-emphasis">maximum temperature, minimum temperature, precipitation,
                        and soil moisture</span> as the basis of our predictor variables maximized accuracy.
                    To preserve the seasonal variations in these measures throughout the year, we chose to
                    <span class="green-emphasis">aggregate data by month of the year</span> when performing
                    feature simplification.
                </p>

                <h4>c) Feature creation</h4>
                <p>
                    During our exploratory data analysis, we plotted different descriptive statistics of
                    the maximum monthly temperature, minimum monthly temperature, precipitation, and soil moisture
                    near target frogs and off-target frogs. We noticed that taking the maximum, minimum, mean, and
                    standard deviation for each month over the timespan of 2015-2019 resulted in large differences
                    for areas containing target frogs versus areas containing off-target frogs in some months
                    (<a href="#figure-2">Figure 2</a>).
                </p>

                <section id="figure-2">
                    <img style="max-width:100%" src="images/fig2-monthly-aggregation.png" alt="">
                </section>
                <p>
                    <b>Figure 2. Example plots of monthly aggregated data for one 1/24° by 1/24° square containing only
                        <i>L. fallax</i>,
                        the target frog, and for one 1/24° by 1/24° square containing only off-target frogs.</b>
                    a) Minimum monthly maximum temperature over the timespan of 2015-2019.
                    We observe that this feature seems to differ for the target and non-target regions in winter and
                    early spring.
                    b) Mean monthly precipitation over the timespan of 2015-2019.
                    We observe that this feature seems to differ for the target and non-target regions in summer.
                </p>

                <p>
                    After training our model, we evaluated the feature performance using the mean decrease in impurity
                    (MDI)
                    (<a href="#figure-3">Figure 3</a>).
                    Of the 192 total features, 40 had an MDI greater than 1/192, indicating that they are important.
                    The top 12 features involved maximum monthly temperature in September and October, and precipitation
                    in January,
                    February, and March.
                </p>

                <section id="figure-3">
                    <img style="max-width:100%" src="images/fig3-feature-importance.png" alt="">
                </section>
                <p>
                    <b>Figure 3. Feature importance by mean decrease in impurity (MDI).</b>
                    Top 25 most important features (out of 192 total features). Features are labeled as
                    “[month] [measurement] [aggregation statistic]”; e.g., “9 tmax min” indicates
                    the minimum of the September maximum temperature over the years 2015–2019.
                </p>

                <p>
                    Other improvements included
                    d) sampling over 9 different geographical areas with varying climate and frog species occurrences,
                    and
                    e) hyperparameter tuning.
                </p>

                <h4>d) Sub-sampling different geographies</h4>

                <p>
                    To build our training dataset, we sub-sampled nine 1° by 1° squares
                    (equivalent to about 111 km by 111 km), including the five evaluation regions,
                    around the coast of Australia (<a href="#figure-4">Figure 4</a>).
                    We selected regions with varying climates to expose our model to a range of data:
                    wet tropical, humid subtropical, subtropical highlands, and temperature climates
                    in both rural and urban regions are included.
                </p>

                <section id="figure-4">
                    <img style="max-width:100%" src="images/fig4-map-of-rois.png" alt="">
                </section>
                <p>
                    <b>Figure 4. Map of Australia showing regions of interest (ROIs).</b>
                    The nine 1° by 1° squares used to subsample our training data.
                    We included the five evaluation ROIs (colored) and added four additional regions of interest to
                    improve the model
                    (black). <i>L. fallax</i> is marked in orange, while other species are marked in red, blue, green,
                    and gold.
                </p>

                <h4>e) Hyperparameter tuning</h4>
                <p>
                    We used our own tuning algorithm to determine the hyperparameters for the random forest classifier.
                    Our final model uses 250 estimators, requires 5 samples to split an internal node, and
                    class-balances
                    the subsamples in the training process. Increasing the number of estimators makes the model perform
                    better,
                    at the expense of training and run time, until a point of diminishing returns.
                    Increasing the number of samples to split an internal node reduces the error due to bias in the
                    model,
                    while increasing the error due to variance in the test data. The class weighting dictates how to
                    treat
                    imbalanced classes in the training dataset.
                </p>

                <p>
                    First, we measured the effect of changing the number of estimators, number of samples to split an
                    internal node,
                    and class weighting independently of one another.
                    Then, we revisited the effect of the last two hyperparameters with the other values fixed.
                </p>

                <section id="results-and-discussion">
                    <h3>Results and discussion</h3>
                </section>
                <p>Our model achieved a <span class="green-emphasis">prediction accuracy score of 0.77 on the unseen
                        data</span>.</p>

                <p>
                    However, it achieved an in-sample F1 score of 0.87 / in-sample accuracy of 0.86,
                    indicating that our model is suffering from overfitting. Using stratified 10-fold cross-validation,
                    we measured an out-of-sample F1 score of 0.86 / out-of-sample accuracy of 0.85.
                    The stratified 10-fold cross-validation used the balanced dataset, but if the unseen data is
                    unbalanced,
                    the performance may decrease. Therefore, we also assessed out-of-sample performance by predicting
                    the frogs
                    from a non-downsampled dataset generated from the evaluation regions.
                    Those predictions had an F1 score of 0.76 / accuracy of 0.80. Looking at the confusion matrices (<a
                        href="figure-5">Figure 5</a>),
                    we observed that most of the test data are absences. The F1 score does not consider correctly
                    identified negatives
                    in its assessment, leading to the higher out-of-sample accuracy score (which considers true
                    negatives and true positives)
                    than out-of-sample F1 score.
                </p>

                <section id="figure-5">
                    <img style="max-width:100%" src="images/fig5-confusion-matrices.png" alt="
                    a: in-sample confusion matrix. True absences: 1e+04; false absences: 672; false presences: 3352; true presences: 13167.
                    b: out-of-sample confusion matrix. True absences: 13527; false abences: 529; false presences: 5234; true presences: 9217.
                    The squares of the matrix are colored by value. The larger values are darker blue and the smaller values are lighter blue.
                    ">
                </section>
                <p>
                    <b>Figure 5. In-sample and out-of-sample confusion matrices.</b>
                    a) In-sample results: confusion matrix from predicting frogs on the training dataset.
                    b) Out-of-sample results: confusion matrix from predicting frogs on the non-downsampled dataset
                    generated from the evaluation regions.
                </p>

                <p>
                    To reduce overfitting, we could restrict the predictor features to the top contributors to the mean
                    decrease in impurity.
                    In addition, it may be possible to improve the model by using grid search cross-validation to
                    optimize the hyperparameters,
                    and by particularly focusing on the size of the random subsets of features to consider when
                    splitting a node [5].
                </p>

                <p>
                    Our model is <span class="green-emphasis">blazingly fast</span> in comparison to the other models we
                    tested, such as support vector,
                    k-neighbors, and gradient boost classifiers. On a consumer-grade laptop (Intel i5-8250U: 8 cores at
                    1.60 GHz),
                    our model can preprocess the predictor variable data and
                    <span class="green-emphasis">predict the presence of <i>L. fallax</i> in a 1° by 1° square of
                        terrain in 50 ms</span>.
                    To increase the speed of predicting large areas of land, each 1° by 1° ROI can be predicted in
                    parallel.
                    Alternatively, a single 1° by 1° region can be further divided to the resolution of the climate
                    data,
                    and each of those subdivisions can be predicted simultaneously. Finally, scaling is not needed for
                    random forest algorithms
                    and so could be eliminated—we left the preprocessing step in the pipeline from testing other
                    algorithms,
                    including distance-based algorithms.
                </p>

                <p>
                    Future work to increase accuracy could involve refining the predictor variable and/or the learning
                    algorithm.
                    All machine learning models risk producing useless results if trained on inappropriate data.
                    We could consult with an amphibian expert on what factors most affect frog health and identify an
                    improved dataset on
                    which to base our predictor variables. Secondly, we could incorporate data on air and water
                    pollution,
                    which are known to negatively affect frogs. Finally, we could obtain weather data of increased
                    geographical and/or
                    temporal resolution. Alternatively, we could continue to use the TerraClimate dataset—we noticed
                    that a “station_influence”
                    parameter is included, and propose weighting TerraClimate data based on its value, assuming data
                    reported by more stations is
                    more reliable. In addition, we could use a different learning algorithm. Although the random forest
                    classifier gave us the
                    best accuracy, we may obtain higher accuracy with another machine learning algorithm with improved
                    hyperparameter tuning.
                    Furthermore, we could try deep learning methods, such as building a neural network using TensorFlow
                    or PyTorch.
                </p>

                <section id="conclusion">
                    <h3>Conclusion</h3>
                </section>
                <p>
                    We developed a species distribution model (SDM) for Litoria fallax in Australia based on a
                    random forest classifier and using predictor variables derived from the TerraClimate dataset.
                    Our model’s F1 score on the unseen data increased to 0.77 from the benchmark of 0.61.
                    In addition, it can be trained on nearly 40,000 data points quickly and predicts unseen data
                    quickly.
                    Finally, although it was evaluated as a binary classifier, it can generate probabilities of frog
                    occurrence.
                </p>

                <p>
                    Due to our SDM’s increased accuracy, it could help with <span class="green-emphasis">identifying
                        candidate regions</span> in which to search for <i>L. fallax</i>.
                    Most current occurrence data obtained from GBIF are collected by citizen scientists.
                    It could be helpful for volunteers or scientists to search for frogs in regions with low documented
                    occurrences,
                    but high probability predicted by our model.
                </p>

                <p>
                    Because the frog population data are collected from citizen scientists, there is less historical
                    information on frog populations
                    in comparison to historical weather data (the TerraClimate dataset contains weather data dating back
                    to 1958).
                    Our model could be <span class="green-emphasis">applied on historical weather data</span> to
                    reconstruct the
                    <i>L. fallax</i> population at different moments from the past and learn how it has changed over the
                    last 60 years,
                    which could <span class="green-emphasis">inform how the species distribution may
                        continue to evolve</span>. In addition, our model could be modified to predict different species
                    of frogs or other animals,
                    and in other parts of the world as well. Our model can be combined with measurements and predictions
                    of the changing climate
                    to extrapolate <span class="green-emphasis">the effect of global warming</span> on
                    frog and other indicator species populations--and thus, the <span class="green-emphasis">health of
                        ecosystems</span>.
                </p>

                <section id="references">
                    <h3>References</h3>
                </section>
                <p>
                    [1] <a
                        href="https://www.nationalgeographic.com/animals/article/these-animals-offer-key-clues-for-environmental-change">Daly,
                        Natasha. “These animals offer key clues for environmental change,” National Geographic
                        (2021-09-17).</a></br>
                    [2] <a
                        href="https://nc.iucnredlist.org/redlist/content/attachment_files/2021-3_RL_Stats_Table_1a_v2.pdf">IUCN.
                        “The IUCN Red List of Threatened Species™” (2021-12-09).</a></br>
                    [3] <a
                        href="www.environment.gov.au/cgi-bin/sprat/public/publicthreatenedlist.pl?wanted=fauna#frogs_extinct">Australian
                        Government Department of Agriculture, Water and the Environment. “EPBC Act List of Threatened
                        Fauna” (accessed 2022-06-11).</a></br>
                    [4] <a href="https://doi.org/10.1071/PC21019">Geyle, H. M., et al. “Red hot frogs: identifying the
                        Australian frogs most at risk of extinction,” Pacific Conservation Biology (2022).</a></br>
                    [5] <a
                        href="https://scikit-learn.org/stable/modules/ensemble.html#random-forest-parameters">scikit-learn
                        1.1.1. “1.11 Ensemble methods” (accessed 2022-06-11).</a></br>
                    <i>Litoria fallax</i> illustrations by Lealia Xiong.
                </p>

                <section id="data-sources">
                    <h4>Data sources</h4>
                </section>
                <p>
                    Datasets were acquired as part of the <a href="https://challenge.ey.com/">EY Data
                        Challenge</a>.</br>
                    Weather data sourced from the <a
                        href="https://planetarycomputer.microsoft.com/dataset/terraclimate">TerraClimate dataset hosted
                        by the Microsoft Planetary Computer</a>.</br>
                    Occurrence data orignally sourced from the <a href="https://www.gbif.org/">Global Biodiversity
                        Information Facility</a>.
                </p>

                <section id="data-tools">
                    <h4>Data tools</h4>
                </section>
                <p>
                    All data analysis and visualization performed in Python, with some help from functions provided in
                    the
                    <a
                        href="https://github.com/EY-Data-Science-Program/2022-Better-Working-World-Data-Challenge/blob/main/notebooks/level_1_challenge/challenge_1_benchmark.ipynb">
                        EY example notebook
                    </a>.
                </p>
                <table style="border-spacing:50px 5px;border-collapse:separate">
                    <tr>
                        <td><b>Analysis</b></td>
                        <td><b>Visualization</b></td>
                    </tr>
                    <tr>
                        <td><a href="https://numpy.org/">NumPy</a></td>
                        <td><a href="https://matplotlib.org/">Matplotlib</a< /td>
                    </tr>
                    <tr>
                        <td><a href="https://pandas.pydata.org/">Pandas</a></td>
                        <td><a href="https://contextily.readthedocs.io/en/latest/">contextily</a></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.xarray.dev/en/stable/">Xarray</a></td>
                        <td><a href="http://python-visualization.github.io/folium/">Folium</a></td>
                    </tr>
                    <tr>
                        <td><a href="https://filesystem-spec.readthedocs.io/en/latest/">fsspec</a></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://pystac.readthedocs.io/en/stable/">PySTAC</a></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://scikit-learn.org/">scikit-learn</a></td>
                        <td></td>
                    </tr>
                </table>

                <div class="cta-button-container">
                    <a href="https://github.com/lealiaxiong/frog-discovery"><button class="cta-button">
                            View on GitHub
                        </button></a>
                </div>

                <p style="text-align: center"><a href="https://github.com/lealiaxiong/frog-discovery">frog-discovery</a>
                    is maintained by <a href="https://github.com/lealiaxiong">lealiaxiong</a>.</p>
            </div>
        </main>

        <div class="site-footer-container wp-block-template-part">
            <div style="height:70px" aria-hidden="true" class="wp-block-spacer"></div>
            <div style="height:120px" aria-hidden="true" class="wp-block-spacer"></div>
        </div>
    </div>

</body>

</html>